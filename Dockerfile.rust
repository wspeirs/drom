# Start from the official Gemini CLI sandbox image
FROM us-docker.pkg.dev/gemini-code-dev/gemini-cli/sandbox:0.28.2

# Switch to root to install packages
USER root

# Install system dependencies for Rust (e.g. build-essential/gcc often needed for linking)
RUN apt-get update && apt-get install -y \
    build-essential \
    curl

# Install Rust (standard official install)
RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y

# Add Cargo to PATH for all future commands
ENV PATH="/root/.cargo/bin:${PATH}"

# (Optional) Verify installation
RUN cargo --version

# Switch back to the default user if you want to maintain standard permission behavior
# (Gemini CLI usually runs as 'node' or a specific user, but root is often fine for sandboxes)
# USER node
